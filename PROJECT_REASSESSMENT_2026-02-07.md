# 프로젝트 재평가 보고서 (2026-02-07)

## 목적

본 문서는 GhostLink 코드베이스를 기능, 안정성, 운영성 관점에서 재점검하고  
즉시 실행 가능한 개선 우선순위를 정의하기 위해 작성되었습니다.

## 현 상태 요약

- 강점
  - FastAPI 기반 라우팅 구조가 명확하고 기능 분리가 양호함
  - 결제/승인/최적화/리포트 등 핵심 도메인이 서비스 계층으로 분리됨
  - 템플릿 기반 UI와 API가 유기적으로 연결되어 제품 흐름이 빠름
- 약점
  - 레거시 요금제(`business`) 흔적이 일부 영역에 남아 일관성 저해
  - 웹훅/감사로그 실패 시 연쇄 오류 가능성 존재
  - 운영 문서와 실제 코드 상태 간 불일치 구간 존재

## 핵심 리스크

1. 구독/가격 매핑 불일치
- Stripe 가격 ID와 내부 플랜 코드가 어긋나면 결제 실패/오표기 위험

2. 비동기 세션 경계 문제
- ORM 객체 직렬화 시점이 트랜잭션 경계를 벗어나면 `MissingGreenlet` 류 오류 발생 가능

3. 감사 로그 쓰기 실패 전파
- 감사 로그 PK/시퀀스 이상이 본 비즈니스 요청 실패로 번질 위험

## 우선순위 실행안

### P0
- 요금제 3단계(`starter/pro/enterprise`)로 정규화
- Stripe 웹훅 멱등성 및 인보이스 조직 매핑 강화
- 감사 로그 쓰기 실패를 비치명 경고로 격리

### P1
- 관리자 CRM 화면 강화(조직 스코프/권한 안전성)
- 운영 점검 스크립트 및 배포 체크리스트 정비

### P2
- 레거시 변수 단계적 제거
- 문서 체계 통일 및 릴리스 노트 자동화

## 성공 기준

- 결제/승인/최적화 루프 핵심 시나리오에서 500 오류 재현 불가
- 웹훅 이벤트 처리 성공률 안정화
- 관리자 화면에서 조직/사용자/결제 상태를 일관되게 파악 가능

## 권장 운영 지표

- `/webhooks/stripe` 5xx 비율
- `/api/v1/optimizations/*` 5xx 비율
- 승인 요청 생성 대비 승인/실패 비율
- 일일 리포트 생성 성공률

## 결론

GhostLink는 이미 제품 운영 가능한 기반을 갖추고 있으며,  
현재 필요한 것은 기능 추가보다 "일관성, 안정성, 운영 문서화"의 완성도 향상입니다.
